COPY supplychain
FROM 'C:\Program Files\PostgreSQL\16\data\COPY DATA\supply_chain_data ORGIN.csv'CSV HEADER

select *
from Supplychain

-----What is the total revenue generated by each product type?
SELECT 
    product_type, 
    SUM(reveneue_generated) AS total_revenue
FROM 
    supplychain
GROUP BY 
    product_type;

-----How many products have been sold for each product type?
SELECT 
    product_type, 
    SUM(number_of_products_sold) AS total_sold
FROM 
    supplychain
GROUP BY 
    product_type;

----What is the average price of each product type?
SELECT 
    product_type, 
    AVG(price) AS average_price
FROM 
    supplychain
GROUP BY 
    product_type;

-----What are the demographics of customers for each product type?
SELECT 
    product_type, 
    customer_demographics, 
    COUNT(*) AS customer_count
FROM 
    supplychain
GROUP BY 
    product_type, 
    customer_demographics;

------What is the total revenue generated from each customer demographic group?
SELECT 
    customer_demographics, 
    SUM(reveneue_generated) AS total_revenue
FROM 
    supplychain
GROUP BY 
    customer_demographics;

-----How many orders have been fulfilled by each supplier?
SELECT 
    suppliers_name, 
    COUNT(*) AS total_orders
FROM 
    supplychain
GROUP BY 
    suppliers_name;

------What is the average lead time for each supplier?
SELECT 
    suppliers_name, 
    AVG(lead_time) AS average_lead_time
FROM 
    supplychain
GROUP BY 
    suppliers_name;

-----What is the total revenue generated by each supplier?
SELECT 
    suppliers_name, 
    SUM(reveneue_generated) AS total_revenue
FROM 
    supplychain
GROUP BY 
    suppliers_name;

-----What is the total revenue generated from each location?
SELECT 
    "Location", 
    SUM(reveneue_generated) AS total_revenue
FROM 
    supplychain
GROUP BY 
    "Location";

-----How many products have been sold in each location?
SELECT 
    "Location", 
    SUM(number_of_products_sold) AS total_sold
FROM 
    supplychain
GROUP BY 
    "Location";

-----What are the current stock levels for each product type?
SELECT 
    product_type, 
    stock_levels
FROM 
    supplychain
GROUP BY 
    product_type, 
    stock_levels;

-----What are the manufacturing costs for each product type?
SELECT 
    product_type, 
    SUM(manufacturing_costs) AS total_cost
FROM 
    supplychain
GROUP BY 
    product_type;

-----What are the average lead times for each product type?
SELECT 
    product_type, 
    AVG(lead_time) AS average_lead_time
FROM 
    supplychain
GROUP BY 
    product_type;
	
-----What are the production volumes for each product type?
SELECT 
    product_type, 
    SUM(production_volumes) AS total_production
FROM 
    supplychain
GROUP BY 
    product_type;

----- What is the total cost incurred from each supplier?
SELECT 
    suppliers_name, 
    SUM("Cost") AS total_cost
FROM 
    supplychain
GROUP BY 
    suppliers_name;

-----What is the profit generated by each product type? 
SELECT 
    product_type, 
    SUM(reveneue_generated) - SUM("Cost") AS profit
FROM 
    supplychain
GROUP BY 
    product_type;

----- What are the order quantities for each product type?
SELECT 
    product_type, 
    SUM(order_quantities) AS total_ordered
FROM 
    supplychain
GROUP BY 
    product_type;	

-----What are the average shipping times for each carrier?
SELECT 
    shipping_carriers, 
    AVG(shipping_times) AS average_shipping_time
FROM 
    supplychain
GROUP BY 
    shipping_carriers;
	
-----What are the total shipping costs for each carrier?
SELECT 
    shipping_carriers, 
    SUM("Cost") AS total_shipping_cost
FROM 
    supplychain
GROUP BY 
    shipping_carriers;	

-----What are the most commonly used transportation modes?
SELECT 
    transportation_modes, 
    COUNT(*) AS usage_count
FROM 
    supplychain
GROUP BY 
    transportation_modes;
	
-----What is the total cost incurred by each transportation mode?
SELECT 
    transportation_modes, 
    SUM("Cost") AS total_cost
FROM 
    supplychain
GROUP BY 
    transportation_modes;	

-----What is the average time from order to delivery?
SELECT 
    AVG(lead_time + shipping_times) AS average_order_to_delivery_time
FROM 
    supplychain;

-----What is the inspection pass rate for each supplier?
SELECT 
    suppliers_name, 
    SUM(CASE WHEN inspection_results = 'Pass' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS pass_rate
FROM 
    supplychain
GROUP BY 
    suppliers_name;
	
-----What are the inspection results for each product type?
SELECT 
    product_type, 
    inspection_results, 
    COUNT(*) AS inspection_count
FROM 
    supplychain
GROUP BY 
    product_type, 
    inspection_results;
	
-----What is the average lead time for each transportation mode?
SELECT 
    transportation_modes, 
    AVG(lead_time) AS average_lead_time
FROM 
    supplychain
GROUP BY 
    transportation_modes;	
	
-----Which routes are most frequently used?
SELECT 
    routes, 
    COUNT(*) AS route_usage_count
FROM 
    supplychain
GROUP BY 
    routes
ORDER BY 
    route_usage_count DESC;	

-----What is the cost breakdown for each product type?
SELECT 
    product_type, 
    SUM(manufacturing_costs) AS total_manufacturing_costs, 
    SUM("Cost") AS total_cost
FROM 
    supplychain
GROUP BY 
    product_type;